---
# Preamble

## Author
author:
  name: Перфилов Александр Константинович | группа НПИбд 03-24
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
   
## Title
title: "Лабораторная работа №3"
subtitle: "Настройка прав доступа"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получение навыков настройки базовых и специальных прав доступа для групп пользователей в операционной системе типа Linux.

# Выполнение лабораторной работы

## Управление базовыми разрешениями

Откроем терминал с учётной записью root
В корневом каталоге создадим каталоги /data/main и /data/third: 
mkdir -p /data/main /data/third

![Создание каталогов с root](image/5363977445180569461.jpg)

Посмотрим, кто является владельцем этих каталогов. Для этого используем: 
ls -Al /data

![Просмотр информации о каталогах](image/5363977445180569461.jpg)

Прежде чем устанавливать разрешения, изменим владельцев этих каталогов с root на main и third соответственно:


chgrp main /data/main
chgrp third /data/third


![Изменение владельцев каталогов](image/5363977445180569462.jpg)

Посмотрим, кто теперь является владельцем этих каталогов: 
ls -Al /data

![Просмотр информации о каталогах](image/5363977445180569462.jpg)

Установим разрешения, позволяющие владельцам каталогов записывать файлы в эти каталоги и запрещающие доступ к содержимому каталогов всем другим пользователям и группам:


chmod 770 /data/main
chmod 770 /data/third


Проверим установленные права доступа

![Изменение разрешений и просмотр прав доступа](image/5363977445180569464.jpg)

В другом терминале перейдем под учётную запись пользователя bob
Попробуем перейти в каталог /data/main и создать файл emptyfile в этом каталоге:

cd /data/main
touch emptyfile
ls -Al

Создался файл с правами под учетную запись пользователя bob

![Создание файла под учётной записью bob](image/5363977445180569474.jpg)

Под пользователем bob попробуем перейти в каталог /data/third и создать файл emptyfile в этом каталоге

![Попытка перейти в каталог](image/5363977445180569474.jpg)

## Управление специальными разрешениями

Откроем новый терминал под пользователем alice.
Перейдем в каталог /data/main: 
cd /data/main
Создадим два файла, владельцем которых является alice:

touch alice1
touch alice2

![Создание файлов под учётной записью alice в каталоге /data/main](image/5363977445180569473.jpg)

В другом терминале перейдем под учётную запись пользователя bob 
Перейдем в каталог /data/main и введем: 
ls -l

![Просмотр информации о каталоге](image/5363977445180569474.jpg)

Мы увидим два файла, созданные пользователем alice. Попробуем удалить файлы, принадлежащие пользователю alice: 
rm -f alice* 
Убедимся, что файлы будут удалены пользователем bob.

![Удаление файлов alice и просмотр информации каталога](image/5363977445180569474.jpg)

Создадим два файла, которые принадлежат пользователю bob:

touch bob1
touch bob2


![Создание файлов под учётной записью bob](image/5363977445180569472.jpg)


В терминале под пользователем root установим для каталога /data/main бит идентификатора группы, а также stiky-бит для разделяемого (общего) каталога группы: 
chmod g+s,o+t /data/main

![Изменение бит индентификатора группы и sticky-бит для общего каталога группы](image/5363977445180569476.jpg)

В терминале под пользователем alice создадим в каталоге /data/main файлы alice3 и alice4:

touch alice3
touch alice4
ls -l


Теперь мы должны увидеть, что два созданных нами файла принадлежат группе main, которая является группой-владельцем каталога /data/main.

![Создание файлов и просмотр информации о них](image/5363977445180569478.jpg)

В терминале под пользователем alice попробуем удалить файлы, принадлежащие пользователю bob: 
rm -rf bob* 

![Попытка удаление файлов](image/5363977445180569465.jpg)

Как мы видим sticky-bit предотвратил удаление этих файлов пользователем alice, поскольку этот пользователь не является владельцем этих файлов. 
Обратим внимание: поскольку пользователь alice является владельцем каталога /data/main, то он может удалить все свои файлы в любом случае.

## Управление расширенными разрешениями с использованием списков ACL

Применим команды setfacl и getfacl для выполнения поставленной задачи.
Откроем терминал с учётной записью root
Установим права на чтение и выполнение в каталоге /data/main для группы third и права на чтение и выполнение для группы main в каталоге /data/third:

setfacl -m g:third:rx /data/main
setfacl -m g:main:rx /data/third

![Изменение прав каталогов для групп](image/5363977445180569469.jpg)

Используем команду getfacl, чтобы убедиться в правильности установки разрешений:

getfacl /data/main
getfacl /data/third


![Просмотр информации о каталогах](image/5363977445180569475.jpg)(image/5363977445180569467.jpg)

Создадим новый файл с именем newfile1 в каталоге /data/main: 
touch /data/main/newfile1
Используем getfacl /data/main/newfile1 для проверки текущих назначений полномочий.

![Создание файла и просмотр информации о нём](image/5363977445180569468.jpg)

Установим ACL по умолчанию для каталога /data/main: 
setfacl -m d:g:third:rwx /data/main

Убедимся, что настройки ACL работают, добавив новый файл в каталог /data/main: 
touch /data/main/newfile2

Используем getfacl /data/main/newfile2 для проверки текущих назначений полномочий

![Создание файла и просмотр информации](image/5363977445180569471.jpg)

Выполним аналогичные действия для каталога /data/third.
Создадим новый файл newfile2 в каталог /data/third и проверим текущие назначения полномочий

![Создание файла и просмотр информации](image/Вставленное изображение.png)

Для проверки полномочий группы third в каталоге /data/third войдем в другом терминале под учётной записью члена группы third: 
su - carol
Проверим операции с файлами:


rm /data/main/newfile1
rm /data/main/newfile2


![Попытка удаление файлов под учётной записью carol](image/5363977445180569477.jpg)

Удалить файлы мы не смогли, так как newfile1 принадлежит пользователю root и группе main, newfile2 также принадлежит root, main и third, хоть и carol находится в последней группе, у группы недостаточно прав.

Проверим, возможно ли осуществить запись в файл:


echo "Hello, world" >> /data/main/newfile1
echo "Hello, world" >> /data/main/newfile2


![Попытка осуществить запись в файлы под учётной записью carol](image/5363977445180569470.jpg)

Мы не смогли осуществить запись в newfile1, так как прав у группы third на нее нет. А вот уже в newfile2 все получилось, так как права на изменение файла у данной группы есть.

# Выводы

Приобретены умения по управлению базовыми и специальными правами доступа для групп пользователей в ОС Linux.

# Список литературы{.unnumbered}

::: {#refs}
:::
